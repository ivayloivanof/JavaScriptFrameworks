"use strict";angular.module("IssueTrackingSystem.controllers.issue",[]).config(["$routeProvider",function(a){a.when("/issues",{templateUrl:"app/issue/partials/issues.html",controller:"Issue"}).when("/issues-all/page=:page/size=:size/filter=:filter",{templateUrl:"app/issue/partials/issues-all.html",controller:"Issue"}).when("/issues/page=:page/size=:size",{templateUrl:"app/issue/partials/issues.html",controller:"Issue"}).when("/issues/:id",{templateUrl:"app/issue/partials/issue-view.html",controller:"Issue"}).when("/issues/:id/edit",{templateUrl:"app/issue/partials/issue-edit.html",controller:"Issue"}).when("/issues/:id/edit/projects=:project",{templateUrl:"app/issue/partials/issue-edit.html",controller:"Issue"}).when("/projects/:id/add-issue",{templateUrl:"app/issue/partials/issue-add.html",controller:"Issue"})}]).controller("Issue",["$scope","debug","issues","$routeParams","$route","$location","$sessionStorage",function(n,d,i,m,j,h,k){n.pageNumber=m.page?m.page:1;n.pageSize=m.size?m.size:5;n.filterPage=m.filter?m.filter:'Status.Name == "In Progress" or DueDate.Day <= 31';n.pagePrev=Number(n.pageNumber)-1;n.pageNext=Number(n.pageNumber)+1;function c(){var o;n.labels="";for(o in n.issue.Labels){n.labels+=n.issue.Labels[o].Name+","}n.labels=n.labels.replace(/,(\s+)?$/,"")}n.getAllIssues=function g(q,p,o){i.getAllIssues(q,p,o).then(function(r){d?console.log("All issues:",r):"";n.issues=r.data.Issues})};n.getIssueById=function e(){i.getIssuesById(m.id).then(function(o){d?console.log("Route params:",m):"";d?console.log("Issue by Id:",o):"";n.issue=o.data;c();k.AssigneeId=o.data.Assignee.Id})};n.getIssueByProjectId=function l(){i.getIssuesByProjectId(m.id).then(function(o){d?console.log("Route params:",m):"";d?console.log("Issues by Project Id:",o):"";n.issues=o.data})};n.getAllCommentsByIssueId=function b(){i.getAllIssueComments(m.id).then(function(o){d?console.log("Route params:",m):"";d?console.log("All Comments:",o):"";n.comments=o.data})};n.getMyIssues=function(p,o){i.getMyIssues(p,o).then(function(q){d?console.log("All my issues:",q):"";n.issues=q.data.Issues})};n.addIssue=function a(o){var p={Title:o.title,Description:o.description,DueDate:o.dueDate,ProjectId:o.projectId,AssigneeId:o.assigneeId,PriorityId:o.priorityId,Labels:[]};o.labels=o.labels.split(",");o.labels.forEach(function(q){p.Labels.push({Name:q.trim()})});i.addIssue(p).then(function(q){d?console.log("Add issue success:",q):"";h.path("/projects/"+m.id)})};n.editIssue=function(p){var o={Id:m.id,AssigneeId:p.assigneeId,Title:p.title,Description:p.description,DueDate:p.dueDate,PriorityId:p.priority,Labels:[]};p.labels=p.labels.split(",");p.labels.forEach(function(q){o.Labels.push({Name:q.trim()})});i.editIssueById(m.id,o).then(function(q){d?console.log("Route params:",m):"";d?console.log("Edited issue:",q):"";h.path("/issues/"+m.id)})};n.addComment=function f(q,o){var p={Author:o,CreatedOn:new Date(),Text:q.text};i.addCommentToIssue(m.id,p).then(function(r){d?console.log("Route params:",m):"";d?console.log("Add Comment success:",r):"";j.reload()})}}]);