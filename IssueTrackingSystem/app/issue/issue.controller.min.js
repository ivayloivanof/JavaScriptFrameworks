"use strict";angular.module("IssueTrackingSystem.controllers.issue",[]).config(["$routeProvider",function(a){a.when("/issues",{templateUrl:"app/issue/partials/issues.html",controller:"Issue"}).when("/issues/:id",{templateUrl:"app/issue/partials/issue-view.html",controller:"Issue"}).when("/issues/:id/edit",{templateUrl:"app/issue/partials/issue-edit.html",controller:"Issue"}).when("/projects/:id/add-issue",{templateUrl:"app/issue/partials/issue-add.html",controller:"Issue"})}]).controller("Issue",["$scope","debug","pageNumber","issues","$routeParams","$route","$location","$sessionStorage",function(q,d,n,j,p,l,i,m){q.page=n;function c(){var r;q.labels="";for(r in q.issue.Labels){q.labels+=q.issue.Labels[r].Name+","}q.labels=q.labels.replace(/,(\s+)?$/,"")}q.getAllIssues=function g(){j.getAllIssues("In Progress",31,1000,1).then(function(r){d?console.log("All issues:",r):"";q.issues=r.data.Issues})};q.getIssueById=function e(){j.getIssuesById(p.id).then(function(r){d?console.log("Route params:",p):"";d?console.log("Issue by Id:",r):"";q.issue=r.data;c();m.AssigneeId=r.data.Assignee.Id})};q.getIssueByProjectId=function o(){j.getIssuesByProjectId(p.id).then(function(r){d?console.log("Route params:",p):"";d?console.log("Issues by Project Id:",r):"";q.issues=r.data})};q.getAllCommentsByIssueId=function b(){j.getAllIssueComments(p.id).then(function(r){d?console.log("Route params:",p):"";d?console.log("All Comments:",r):"";q.comments=r.data})};q.getMyIssues=function(){console.log(n);j.getMyIssues(n).then(function(r){d?console.log("All my issues:",r):"";q.issues=r.data.Issues})};q.nextPage=function k(r){console.log(r)};q.prevPage=function h(r){console.log(r)};q.addIssue=function a(r){var s={Title:r.title,Description:r.description,DueDate:r.dueDate,ProjectId:r.projectId,AssigneeId:r.assigneeId,PriorityId:r.priorityId,Labels:[]};r.labels=r.labels.split(",");r.labels.forEach(function(t){s.Labels.push({Name:t.trim()})});j.addIssue(s).then(function(t){d?console.log("Add issue success:",t):"";i.path("/")})};q.editIssue=function(s){var r={Id:p.id,AssigneeId:s.assigneeId,Title:s.title,Description:s.description,DueDate:s.dueDate,PriorityId:s.priority,Labels:[]};s.labels=s.labels.split(",");s.labels.forEach(function(t){r.Labels.push({Name:t.trim()})});j.editIssueById(p.id,r).then(function(t){d?console.log("Route params:",p):"";d?console.log("Edited issue:",t):"";i.path("/issues/"+p.id)})};q.addComment=function f(t,r){var s={Author:r,CreatedOn:new Date(),Text:t.text};j.addCommentToIssue(p.id,s).then(function(u){d?console.log("Route params:",p):"";d?console.log("Add Comment success:",u):"";l.reload()})}}]);