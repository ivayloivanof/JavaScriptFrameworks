"use strict";angular.module("IssueTrackingSystem.controllers.project",[]).config(["$routeProvider",function(a){a.when("/projects-all",{templateUrl:"app/project/partials/projects-all.html",controller:"Project"}).when("/projects/add",{templateUrl:"app/project/partials/project-add.html",controller:"Project"}).when("/projects/:id/edit",{templateUrl:"app/project/partials/project-edit.html",controller:"Project"}).when("/projects/:id",{templateUrl:"app/project/partials/project-view.html",controller:"Project"}).when("/projects",{templateUrl:"app/project/partials/projects.html",controller:"Project"})}]).controller("Project",["$scope","debug","projects","users","$routeParams","$location","$sessionStorage",function(n,c,e,d,m,f,l){n.getAllUsers=function(){d.getAllUsers().then(function(p){c?console.log("All users:",p):"";n.allUsers=p.data})};function i(s,p){var q,r;q={Description:s.description,Labels:[],LeadId:s.leadId,Name:s.name,Priorities:[]};s.labels=s.labels.split(",");s.labels.forEach(function(t){q.Labels.push({Name:t})});s.priorities=s.priorities.split(",");s.priorities.forEach(function(t){q.Priorities.push({Name:t})});if(p==="add"){r=s.name.split(/\s+/g);q.ProjectKey="";r.forEach(function(t){q.ProjectKey+=t.charAt(0).toUpperCase()})}return q}n.addProject=function h(p){d.getCurrentUser().then(function(q){c?console.log("Current user:",q):"";var r=i(p,"add");e.addProject(r).then(function(s){c?console.log("Success add Project:",s):"";f.path("/projects/"+s.data.Id)},function(s){console.error(s)})},function(q){console.error(q)})};n.editProject=function k(p){d.getCurrentUser().then(function(q){c?console.log("Current user:",q):"";var r=i(p,"edit");console.log(r);e.editProjectById(n.project.Id,r).then(function(s){c?console.log("Success edit Project:",s):"";f.path("/projects/"+s.data.Id)},function(s){console.error(s)})},function(q){console.error(q)})};n.getAllProjects=function o(){e.getAllProjects().then(function(p){c?console.log("All projects:",p):"";n.projects=p.data})};n.getMyProjects=function j(){e.getProjectByFilter(10,1,"Lead.Id",l.Id).then(function(p){c?console.log("My projects:",p):"";n.myProjects=p.data})};function b(){var p;n.labels="";for(p in n.project.Labels){n.labels+=n.project.Labels[p].Name+","}n.labels=n.labels.replace(/,(\s+)?$/,"")}function g(){var p;n.priorities="";for(p in n.project.Priorities){n.priorities+=n.project.Priorities[p].Name+","}n.priorities=n.priorities.replace(/,(\s+)?$/,"")}n.getProjectById=function a(){e.getProjectById(m.id).then(function(p){c?console.log("Route params:",m):"";c?console.log("Project:",p):"";n.project=p.data;b();g()})}}]);