"use strict";angular.module("IssueTrackingSystem.controllers.user",[]).config(["$routeProvider",function(a){a.when("/profile/password",{templateUrl:"app/user/partials/change-password.html",controller:"User"}).when("/users",{templateUrl:"app/user/partials/users-all.html",controller:"User"})}]).controller("User",["$scope","debug","$location","authentication","$sessionStorage","users","$route",function user(l,a,f,h,k,d,j){l.getAllUsers=function(){d.getAllUsers().then(function(m){a?console.log("All users:",m):"";l.allUsers=m.data})};l.loginUserInSystem=function(m){h.loginUser(m).then(function(n){k.isAuthenticated=true;k.access_token=n.data.access_token;k.token_type=n.data.token_type;k.username=n.data.userName;d.getCurrentUser().then(function(o){k.isAdmin=o.data.isAdmin;k.Id=o.data.Id;a?console.log("Current user:",o):""},function(o){console.error(o)});a?console.log("Logged user:",n):"";f.path("/login")},function(n){console.error(n)})};l.registerUserInSystem=function(m){h.registerUser(m).then(function(o){var n={username:m.email,password:m.password};a?console.log(o):"";l.loginUserInSystem(n)},function(n){console.error(n)})};l.changeUserPassword=function b(m){d.changePassword(m).then(function(n){a?console.log("Changed password:",n):"";f.path("/")},function(n){console.error(n)})};l.logoutUser=function(){h.logout();f.path("/logout")};l.hasLogged=function g(){if(k.isAuthenticated){return true}k.isAuthenticated=false;f.path("/")};l.getCurrentUser=function c(){d.getCurrentUser().then(function(m){a?console.log("Current User:",m):"";l.currentUser=m.data})};l.makeAdmin=function(m){d.makeUserAdmin(m).then(function(n){a?console.log("User changed to admin:",n):"";j.reload()})};l.isAdmin=function i(){if(k.isAdmin){return true}return false};l.isLead=function e(){if(k.LeadId===k.Id){return true}return false}}]);