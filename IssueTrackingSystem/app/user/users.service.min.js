"use strict";angular.module("IssueTrackingSystem.services.users",[]).factory("users",["$http","$q","BASE_URL","header","$sessionStorage",function(h,e,g,d,i){function f(){var j=e.defer();h({method:"get",url:g+"users",headers:d.authenticationHeader()}).then(function(k){j.resolve(k)}).then(function(k){j.reject(k)});return j.promise}function a(){var j=e.defer();h({method:"get",url:g+"users/me/",headers:d.authenticationHeader()}).then(function(k){j.resolve(k)},function(k){j.reject(k)});return j.promise}function c(j){a().then(function(l){if(!l.isAdmin){console.error("Only admins can access this endpoint.");return}var k=e.defer();var m="UserId="+j;h({method:"put",url:g+"users/makeadmin",data:m,headers:d.authenticationHeaderAndWWWContent()}).then(function(n){k.resolve(n)},function(n){k.reject(n)});return k.promise},function(k){console.error(k)})}function b(k){if(k.passwordNew!==k.passwordNewConfirm){console.error("Passwords new and old do not match.");return}var j=e.defer();var l="OldPassword="+k.passwordOld+"&NewPassword="+k.passwordNew+"&ConfirmPassword="+k.passwordNewConfirm;h({method:"post",url:g+"api/Account/ChangePassword",data:l,headers:d.authenticationHeaderAndWWWContent()}).then(function(m){j.resolve(m)},function(m){j.reject(m)});return j.promise}return{getAllUsers:f,getCurrentUser:a,makeUserAdmin:c,changePassword:b}}]);