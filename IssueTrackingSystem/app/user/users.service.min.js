"use strict";angular.module("IssueTrackingSystem.services.users",[]).factory("users",["$http","$q","BASE_URL","header","$sessionStorage",function(h,e,g,d,i){function f(){var j=e.defer();h({method:"get",url:g+"users",headers:d.authenticationHeader()}).then(function(k){j.resolve(k)}).then(function(k){j.reject(k)});return j.promise}function a(){var j=e.defer();h({method:"get",url:g+"users/me/",headers:d.authenticationHeader()}).then(function(k){j.resolve(k)},function(k){j.reject(k)});return j.promise}function c(k){if(!i.isAdmin){console.error("Only admins can change user to Admin.")}var j=e.defer();h({method:"put",url:g+"users/makeadmin",data:"UserId="+k,headers:d.authenticationHeaderAndWWWContent()}).then(function(l){j.resolve(l)},function(l){j.reject(l)});return j.promise}function b(k){if(k.passwordNew!==k.passwordNewConfirm){console.error("Passwords new and old do not match.");return}var j=e.defer();var l="OldPassword="+k.passwordOld+"&NewPassword="+k.passwordNew+"&ConfirmPassword="+k.passwordNewConfirm;h({method:"post",url:g+"api/Account/ChangePassword",data:l,headers:d.authenticationHeaderAndWWWContent()}).then(function(m){j.resolve(m)},function(m){j.reject(m)});return j.promise}return{getAllUsers:f,getCurrentUser:a,makeUserAdmin:c,changePassword:b}}]);